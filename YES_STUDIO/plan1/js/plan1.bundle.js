(()=>{let e=new Object,t=new Object,s=(new Object,null),i=0,r=!1,n=null,l=null;class a{constructor(e,t,s,i,r,n,l,a,o){this.x=e,this.y=t,this.dx=s,this.dy=i,this.raduis=r,this.slide=n,this.idx=l,this.flag=a,this.click=o}draw(){return this}update(){this.flag||((this.x+this.raduis>window.innerWidth-this.slide.clientWidth||this.x-this.raduis<0)&&(this.dx=-this.dx),(this.y+this.raduis>window.innerHeight-this.slide.clientHeight||this.y-this.raduis<0)&&(this.dy=-this.dy),this.idx%2==0?this.x+=this.dx:this.x-=this.dx,this.idx%2==0?this.y+=this.dy:this.y-=this.dy,this.slide.style.transform="translate("+this.x+"px, "+this.y+"px)")}}document.querySelector(".loading").classList.add("show");const o=e=>{const t=window.getComputedStyle(e),s=new DOMMatrixReadOnly(t.transform);return{translateX:s.m41,translateY:s.m42}},c=e=>window.innerWidth/2-e.clientWidth/2,d=e=>window.innerHeight/2-e.clientHeight/2,h=(e,n)=>{n&&(n.style.transform=`translate(${c(n)}px, ${d(n)}px) scale(${Number((4+(e=>{let t=e.clientWidth,s=e.clientHeight,i=0;return i=t>=s?window.innerHeight/s:window.innerWidth/t,i})(n)).toFixed(1))})`),(e=>{r=!1,s=new Image,s.src=t[e.idx][i].src,s.setAttribute("data-color",t[e.idx][i].color),s.classList.add("sequence-img"),s.classList.add("active-sequence"),document.body.appendChild(s),l.innerText=t[e.idx][i].link,l.style.color=t[e.idx][i].color,s.classList.add("show-first-before"),setTimeout((()=>{s.classList.remove("show-first-before"),s.classList.add("show-first-after"),setTimeout((()=>{s.classList.remove("show-first-after"),r=!0}),1)}),201)})(e),i!==t[e.idx].length-1&&s.addEventListener("click",(()=>{if(!r)return;i+=1;let t=Math.abs((window.innerHeight-s.clientHeight)/2+s.clientHeight-50);s.classList.remove("active-sequence"),s.classList.add("prev-sequence");const n=document.querySelectorAll(".prev-sequence");let l=0;for(let e=0;e<n.length;e++){let s=o(n[e]).translateX,i=o(n[e]).translateY;l=0-Number(Math.abs(i)+Math.abs(t)),n[e].style.transform=`translate(${s}px, ${l}px) scale(1)`}h(e)}))},m=(e,t)=>{s?(s.style.transition="transform 0.2s ease-in, opacity 0.2s ease-in",s.style.opacity=0,s.style.transform="translate(-50%, -50%) scale(0.6)",setTimeout((()=>{[...document.querySelectorAll("img.sequence-img")].map((e=>e.remove())),e.classList.remove("active"),e.parentNode.style.transform=`translate(${c(e)}px, ${d(e)}px) scale(4)`}),201)):(e.classList.remove("active"),e.parentNode.style.transform=`translate(${c(e)}px, ${d(e)}px) scale(4)`),l.innerText=t.slide.querySelector("img.img-home").dataset.link,l.style.color=t.slide.querySelector("img.img-home").dataset.color},u=e=>{const t=e.currentTarget.param;if(e.target.classList.contains("active"))return((e,t)=>{if(i=0,r=!1,document.querySelectorAll(".prev-sequence").length>0){const i=document.querySelectorAll(".sequence-img");let r=i.length>11?i.length/50:.2;for(let n=0,l=Promise.resolve();n<i.length;n++)l=l.then((()=>(1,new Promise(((e,t)=>{setTimeout((()=>{e()}),1)}))))).then((()=>{if(0===n)i[n].style.transition=`transform ${r}s ease-in`,i[n].style.transform="translate(-50%, -50%) scale(1)";else{let e=o(i[n]).translateX,t=Math.abs(o(i[(l=[n],a=i.length,c=a-1,d=a-1,h=l.map((function(e){return 0-(0-d)/(c-0)*(c-e)})),parseInt(h.join("")))]).translateY);i[n].style.transition=`transform ${r}s ease-in`,i[n].style.transform=`translate(${e}px, ${t}px) scale(1)`}var l,a,c,d,h;n===i.length-1&&(s=i[0],setTimeout((()=>{m(e,t)}),Number(1e3*r+100)))}))}else m(e,t)})(e.target,t);e.target.classList.add("active"),setTimeout((()=>{h(t,e.target.parentNode)}),1)},g={show:e=>{const t=document.querySelector(".bg");t.classList.add("show"),t.style.backgroundColor="rgba(0,0,0,1)",t.onclick=()=>{null!==n&&(n.classList.remove("active"),n.removeEventListener("click",u)),g.hide(),e.slide.style.transform=`translate(${e.x}px, ${e.y}px) scale(1)`,setTimeout((()=>{e.slide.style.removeProperty("transition"),e.slide.classList.remove("active"),e.click=!1,e.flag=!1}),201)}},hide:()=>{const e=document.querySelector(".bg");e.style.backgroundColor="rgba(0,0,0,0)",setTimeout((()=>{e.classList.remove("show")}),201),null!==l&&l.remove()}},y=e=>{let s=[];for(let t=0;t<e.length;t++){let i=10*Math.random()+1,r=o(e[t]).translateX,n=o(e[t]).translateY,l=4*Math.random(),c=4*Math.random();s.push(new a(r,n,l,c,i,e[t],t,!1,!1))}!function e(){requestAnimationFrame(e),s.forEach((e=>{e.draw().update(),e.slide.onmouseover=()=>{e.flag=!0},e.slide.onclick=()=>{var s;e.click=!0,e.flag=!0,(s=e).slide.classList.contains("active")||(s.slide.classList.add("active"),s.slide.style.transition="transform .2s ease-in",s.slide.style.transform=`translate(${c(s.slide)}px, ${d(s.slide)}px) scale(4)`,l=document.createElement("div"),l.classList.add("link-txt"),l.innerText=s.slide.querySelector("img.img-home").dataset.link,l.style.color=s.slide.querySelector("img.img-home").dataset.color,document.body.appendChild(l),g.show(s),t[s.idx].length>0?(n=s.slide.querySelector("img.img-home"),n.addEventListener("click",u),n.param=s):n=null)},e.slide.onmouseleave=()=>{e.click||(e.flag=!1)}}))}(),document.querySelector(".loading").classList.remove("show")};document.onreadystatechange=()=>{"complete"===document.readyState&&(async()=>{try{const s=await new Promise(((e,t)=>{const s=document.querySelector(".floating-list").querySelectorAll(".sequence");if(s.length<1)return;const i=[];for(let e=0;e<s.length;e++){const t=[];i.push(t);const r=s[e].querySelector(".sequence-list");if(r){const e=r.querySelectorAll("img");if(e.length>0)for(let s=0;s<e.length;s++)t.push({src:e[s].src,link:e[s].dataset.link,color:e[s].dataset.color}),s===e.length-1&&r.remove()}}e(i)}));BrowserFS.install(window),BrowserFS.configure({fs:"LocalStorage"},(i=>{if(i)throw i;const r=BrowserFS.BFSRequire("fs");r.writeFileSync("./sequence.json",JSON.stringify(s),(e=>{if(e)throw e})),e=r.readFileSync("./sequence.json"),t=JSON.parse(e.toString()),(e=>{const t=document.querySelector(".floating-list");let s=new Object,i=0,r=0;for(let t of e)s=t.querySelector("img"),i=s.clientWidth/4,r=s.clientHeight/4,t.style.cssText=`\n      width: ${i}px;\n      height: ${r}px;\n      transform: translate(${l=i,Math.floor(Math.random()*(window.innerWidth-l-100-100))+100}px, ${n=r,Math.floor(Math.random()*(window.innerHeight-n-100-100))+100}px);\n    `;var n,l;t.classList.add("show"),y(e)})(document.querySelectorAll(".sequence"))}))}catch(e){alert(e+" :: 이미지를 저장 할 수 없습니다.")}})()}})();